<!DOCTYPE html>
<html>
<head>
    <title>Mafia Dealer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <style>
        body { font-family: -apple-system, sans-serif; padding: 20px; background: #121212; color: #fff; text-align: center; }
        .card { background: #1e1e1e; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); max-width: 400px; margin: auto; }
        h2 { color: #007AFF; margin-bottom: 5px; }
        textarea { width: 100%; padding: 15px; border: 1px solid #333; border-radius: 12px; background: #2c2c2e; color: #fff; font-size: 16px; box-sizing: border-box; }
        button { width: 100%; padding: 18px; background: #007AFF; color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 18px; cursor: pointer; margin-top: 15px; }
        .role-display { font-size: 32px; font-weight: bold; margin: 30px 0; min-height: 40px; color: #ff3b30; }
        .instruction { font-size: 18px; color: #8e8e93; margin-bottom: 10px; }
        .hidden { display: none; }
        .player-name { font-size: 24px; color: #34c759; margin-bottom: 5px; }
    </style>
</head>
<body>

<div class="card">
    <div id="setup-screen">
        <h2>Mafia Dealer ðŸ”ª</h2>
        <p class="instruction">Enter player names (one per line):</p>
        <textarea id="names" rows="8" placeholder="Alice&#10;Bob&#10;Charlie&#10;David"></textarea>
        <button onclick="startGame()">Start Game</button>
    </div>

    <div id="game-screen" class="hidden">
        <p class="instruction">Pass the phone to:</p>
        <div id="currentPlayerName" class="player-name"></div>
        
        <div id="roleBox" class="role-display">---</div>
        
        <button id="actionBtn" onclick="handleAction()">Tap to Reveal</button>
        <p id="counter" style="margin-top: 15px; color: #555;"></p>
    </div>
</div>

<script>
    let players = [];
    let currentIndex = 0;
    let isRevealed = false;

    function startGame() {
        const input = document.getElementById('names').value.trim();
        if (!input) return alert("Enter at least 3 names!");

        const nameList = input.split('\n').map(n => n.trim()).filter(n => n !== "");
        if (nameList.length < 3) return alert("You need at least 3 players!");

        // Create roles: 1 Mafia, 1 Doctor, rest Villagers
        let roles = ['MAFIA ðŸ”ª', 'DOCTOR ðŸ©º'];
        while (roles.length < nameList.length) {
            roles.push('VILLAGER ðŸ§‘â€ðŸŒ¾');
        }

        // Shuffle roles
        roles = roles.sort(() => Math.random() - 0.5);

        // Combine names and roles
        players = nameList.map((name, index) => ({
            name: name,
            role: roles[index]
        }));

        // Switch screens
        document.getElementById('setup-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        updateScreen();
    }

    function updateScreen() {
        if (currentIndex < players.length) {
            document.getElementById('currentPlayerName').innerText = players[currentIndex].name;
            document.getElementById('roleBox').innerText = "???";
            document.getElementById('roleBox').style.color = "#555";
            document.getElementById('actionBtn').innerText = "Tap to Reveal";
            document.getElementById('counter').innerText = `Player ${currentIndex + 1} of ${players.length}`;
            isRevealed = false;
        } else {
            // End of game
            document.getElementById('currentPlayerName').innerText = "All roles assigned!";
            document.getElementById('roleBox').innerText = "Good Luck!";
            document.getElementById('actionBtn').innerText = "New Game";
            document.getElementById('actionBtn').onclick = () => location.reload();
        }
    }

    function handleAction() {
        const roleBox = document.getElementById('roleBox');
        const btn = document.getElementById('actionBtn');

        if (!isRevealed) {
            // REVEAL ROLE
            roleBox.innerText = players[currentIndex].role;
            roleBox.style.color = players[currentIndex].role.includes('MAFIA') ? '#ff3b30' : '#34c759';
            btn.innerText = "Hide & Next Player";
            isRevealed = true;
        } else {
            // HIDE AND MOVE ON
            currentIndex++;
            updateScreen();
        }
    }
</script>

</body>
</html>
